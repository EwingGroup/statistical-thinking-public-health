---
# Please do not edit this file directly; it is auto generated.
# Instead, please edit 01-describeVariable.md in _episodes_rmd/
source: Rmd
title: "Estimating the mean, variance and standard deviation"
objectives:
  - "Estimate the mean, variance and standard deviation of a variable through simulation."
  - "Interpret the standard deviation as the average difference between sampled values and the mean."
keypoints:
  - The mean is the average value expected in the population. The mean is also known as the expectation.
  - The variance is the average of the squared differences between values in the distribution and the mean of the distribution.
  - The standard deviation is the square root of the variance. It represents the average difference between values in the distribution and the mean of the distribution. 
questions:
  - How are the mean, variance and standard deviation calculated and interpreted?
teaching: 10
execises: 10
---



Often when doing statistics, we have a variable of interest, for which we want to
estimate particular properties. A variable will follow a *distribution*, which shows
how prevalent different values are. In this episode we will learn to estimate and 
interpret the mean, variance and standard deviation of a variable's distribution. 
These values allow us to estimate the average of a variable in the population and the 
variation around that average. 

Before discussing the definitions of these values, let's look at an example. The
heights of people of the female sex in the US approximately follow a distribution 
with a mean of 162 cm and a standard deviation of 6.89 cm. 
The distribution is shown below. 

<img src="../fig/rmd-01-height density plot-1.png" title="plot of chunk height density plot" alt="plot of chunk height density plot" width="612" style="display: block; margin: auto;" />

You may recognise the shape of the above distribution. It is an example of a
*normal* distribution. 

Let's say we have sampled 1000 observations of female height. 
We can refer to these observations as $y_i$, with $i = 1, \dots, 1000$. 
The distribution of female heights has a few properties of interest, which we can estimate using our sample.

## The mean
The *mean* of the distribution is the average of all the values that make up that distribution. In the case of female heights in the US, the mean is 162 cm. Therefore, the average height of a US female is 162 cm. We also expect the mean of our sample to equal 162 cm.

The mean is also known as the *expectation* of a variable, $E()$. The expectation of female heights is expressed as $E(y)$. 

## The variance
The *variance* is the average *squared* difference between values in the distribution 
and the mean of the distribution. This is a mouthful, so it is useful to look
at the equation of variance. The variance is expressed as $V()$:  

$$V(y) = E( (y - E(y))^2 )$$

Breaking this down, we see that the variance is calculated using:
* $y - E(y)$, i.e. the difference between an observed height and the mean height.  
* $(y - E(y))^2$, i.e. the squared difference between an observed height and the mean height.  
* $E( (y - E(y))^2 )$, i.e. the expectation of this squared difference.

Why are we interested in this value? We are mainly interested in the variance
because it allows us to calculate the standard deviation, which has an intuitive
interpretation. Let's look at this below.

## The standard deviation
The *standard deviation* of a distribution is the *square root* of the variance.
The standard deviation is expressed as $\sigma_y$:

$$\sigma_y = \sqrt{V(y)}$$

The standard deviation is interpreted as the average difference between a 
value in the distribution and the mean of that distribution. In the case
of female heights in the US, with a standard deviation of 6.89 cm, we expect
the average difference between a female's height and the mean height of 112 cm to
be 6.89 cm. 

## Estimating the mean, variance and standard deviation through simulation
Another route to understanding the mean, variance and standard deviation is
through *simulation*. This is the process of *sampling* data from a distribution
using R. 

For example, we can sample 1000 observations from the distribution
of female heights in the US using `rnorm()`. We store these values in a tibble,
with the column named `heights`.


~~~
sample <- tibble(heights = rnorm(1000, mean = 112, sd = 6.89))
~~~
{: .language-r}

Before calculating the mean, variance and standard deviation, let's create
a histogram of our sample. Although not a perfect representation, our histogram
looks quite similar to the distribution shown at the start of this episode. Your
plot might differ slightly from the histogram shown below, as `rnorm()` obtained
a random sample. 


~~~
ggplot(sample, aes(x = heights)) +
  geom_histogram()
~~~
{: .language-r}

<img src="../fig/rmd-01-histogram sample female heights-1.png" title="plot of chunk histogram sample female heights" alt="plot of chunk histogram sample female heights" width="612" style="display: block; margin: auto;" />

We can calculate the mean of our sample using `mean()`. This value lies 
close to the original mean of 112 cm. Here we see that the mean of a distribution
approximately equals the mean of our sample.


~~~
meanHeight <- mean(sample$heights)
meanHeight
~~~
{: .language-r}



~~~
[1] 111.6164
~~~
{: .output}

We can also calculate the variance as the mean of the squared differences
between our sampled observations and the mean of our sample:


~~~
variance <- mean( (sample$heights - meanHeight)^2 )
variance
~~~
{: .language-r}



~~~
[1] 48.42329
~~~
{: .output}

Finally, we calculate the standard deviation as the square root of the variance.
The square root is obtained using `sqrt()`. Recall that this is the average
difference between sampled heights and the mean height. 


~~~
sqrt(variance)
~~~
{: .language-r}



~~~
[1] 6.958685
~~~
{: .output}


> ## Exercise
> The normal distribution of systolic blood pressure has a mean of 112 mmHg 
> and a standard deviation of 10 mmHg. The distribution looks as follows:
> <img src="../fig/rmd-01-blood pressure density plot-1.png" title="plot of chunk blood pressure density plot" alt="plot of chunk blood pressure density plot" width="612" style="display: block; margin: auto;" />
> A) Sample one thousand observations from this distribution. Then, create a histogram of your sample.  
> B) Calculate the average systolic blood pressure in your sample.
> Does this value correspond to the mean of the distribution?    
> C) Calculate the variance of your sample.  
> D) Calculate the standard deviation of your sample. How is the standard deviation interpreted here?
> 
> > ## Solution
> > A) We obtain 1000 observations from the systolic blood pressure distribution using `rnorm()`. 
> > We store these values in an object named `sample`. We then create a histogram
> > using `geom_histogram()`.
> > 
> > 
> > ~~~
> > sample <- tibble(bloodPressure = rnorm(1000, mean = 112, sd = 10))
> > 
> > ggplot(sample, aes(x = bloodPressure)) +
> >   geom_histogram()
> > ~~~
> > {: .language-r}
> > 
> > <img src="../fig/rmd-01-blood pressure sample and histogram-1.png" title="plot of chunk blood pressure sample and histogram" alt="plot of chunk blood pressure sample and histogram" width="612" style="display: block; margin: auto;" />
> > 
> > B) We can then calculate the average systolic blood pressure 
> > in our sample using `mean()`. The mean of our sample lies closely to the mean of the original distribution. 
> > 
> > 
> > ~~~
> > meanBP <- mean(sample$bloodPressure)
> > ~~~
> > {: .language-r}
> > 
> > C) The variance equals the average of the squared differences between the mean of the distribution and the
> > observed values. This can be calculated as follows:
> > 
> > 
> > ~~~
> > variance <- mean( (sample$bloodPressure - meanBP)^2 )
> > variance
> > ~~~
> > {: .language-r}
> > 
> > 
> > 
> > ~~~
> > [1] 98.28981
> > ~~~
> > {: .output}
> > 
> > D) The standard deviation equals the square root of the variance. 
> > It is interpreted as the average difference between a sampled systolic blood pressure 
> > and the mean systolic blood pressure. The square root can be calculated using `sqrt()`. 
> > 
> > 
> > ~~~
> > sqrt(variance)
> > ~~~
> > {: .language-r}
> > 
> > 
> > 
> > ~~~
> > [1] 9.914122
> > ~~~
> > {: .output}
> {: .solution}
{: .challenge}

